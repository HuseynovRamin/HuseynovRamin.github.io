<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MyWater</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#060b18">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{
  --bg:#060b18;
  --card:#121a2f;
  --accent:#4fd1ff;
  --accent2:#6b7cff;
  --text:#fff;
  --muted:#9aa4bf;
}
*{box-sizing:border-box;font-family:Poppins}
body{margin:0;background:radial-gradient(circle at top,#162044,#060b18);color:var(--text)}
.app{max-width:420px;margin:auto;padding:14px;padding-bottom:90px}

/* CARD */
.card{
  background:linear-gradient(180deg,#151f3f,#0f1630);
  border-radius:26px;
  padding:18px;
  margin-bottom:16px;
}

/* BOTTLE */
.bottle{
  width:150px;height:280px;margin:16px auto;
  border-radius:36px;border:3px solid rgba(255,255,255,.25);
  position:relative;overflow:hidden;
}
.water{
  position:absolute;bottom:0;width:100%;height:0%;
  background:linear-gradient(180deg,#7be7ff,#3fa9f5);
  transition:height .6s ease;
}

/* BUTTON */
button{
  width:100%;padding:14px;
  border:none;border-radius:18px;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  font-weight:700;color:#000;
  cursor:pointer;
}

/* NAV */
.nav{
  position:fixed;bottom:0;left:0;right:0;
  background:#0b1228;
  display:flex;justify-content:space-around;
  padding:12px 0;
}
.nav i{color:var(--muted);font-size:1.3rem}
.nav i.active{color:var(--accent)}

/* MODAL */
.modal{
  position:fixed;inset:0;
  background:rgba(0,0,0,.65);
  display:none;align-items:center;justify-content:center;
  z-index:50;
}
.modal-content{width:90%;max-width:380px}

/* GENDER */
.gender-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;margin-top:24px;
}
.gender-grid button{
  padding:20px;font-size:18px;
}

/* RULER */
.rwrap{position:relative;height:80px;overflow:hidden}
.ruler{
  display:flex;overflow-x:scroll;
  scrollbar-width:none;
  padding:0 50%;
}
.ruler::-webkit-scrollbar{display:none}
.tick{width:22px;flex-shrink:0;position:relative}
.tick::after{
  content:"";position:absolute;bottom:0;left:50%;
  transform:translateX(-50%);
  width:2px;height:26px;background:rgba(255,255,255,.4)
}
.tick.major::after{height:40px;background:#fff}
.tick span{
  position:absolute;top:-18px;left:50%;
  transform:translateX(-50%);
  font-size:12px;color:var(--muted)
}
.center-line{
  position:absolute;top:0;bottom:0;left:50%;
  width:2px;background:#ff4d4d
}

/* AGE */
.age-wheel{
  display:flex;overflow-x:scroll;
  scrollbar-width:none;
  padding:0 50%;
}
.age-wheel::-webkit-scrollbar{display:none}
.age-item{
  width:60px;text-align:center;
  font-size:22px;color:var(--muted)
}
.age-item.active{
  color:var(--accent);
  font-weight:700;
  transform:scale(1.3);
}
</style>
</head>

<body>

<div class="app">
  <div class="card">
    <h2 style="text-align:center">Today</h2>
    <div class="bottle"><div class="water" id="water"></div></div>
    <div id="consumed" style="text-align:center">0 ml</div>
    <div id="goal" style="text-align:center;font-weight:700"></div>
    <button onclick="openDrink()">Add Drink</button>
  </div>
</div>

<!-- ONBOARDING -->
<div class="modal" id="onboarding">
  <div class="modal-content card" id="stepBox"></div>
</div>

<!-- DRINK -->
<div class="modal" id="drinkModal">
  <div class="modal-content card">
    <h3>Select Drink</h3>
    <div class="gender-grid">
      <button onclick="selectDrink('water')">üíß Water</button>
      <button onclick="selectDrink('coffee')">‚òï Coffee</button>
      <button onclick="selectDrink('tea')">üçµ Tea</button>
      <button onclick="selectDrink('soda')">ü•§ Soda</button>
      <button onclick="selectDrink('juice')">üßÉ Juice</button>
      <button onclick="selectDrink('milk')">ü•õ Milk</button>
    </div>
  </div>
</div>

<div class="nav">
  <i class="fa-solid fa-droplet active"></i>
  <i class="fa-solid fa-user" onclick="startOnboarding()"></i>
</div>

<script>
/* STATE */
let profile = JSON.parse(localStorage.getItem("profile")) || {};
let data = JSON.parse(localStorage.getItem("data")) || {};
let today = new Date().toDateString();
if(!data[today]) data[today]={consumed:0};

const DRINKS = {
  water:1,
  coffee:0.98,
  tea:0.99,
  soda:0.93,
  juice:0.88,
  milk:0.87
};

/* HAPTIC */
const haptic=()=>navigator.vibrate&&navigator.vibrate(10);

/* GOAL */
function calcGoal(){
  let g = profile.weight * 35;
  if(profile.gender==="male") g*=1.1;
  return Math.round(g/50)*50;
}

/* UI */
function updateUI(){
  let g=calcGoal(), c=data[today].consumed;
  goal.innerText="Goal: "+g+" ml";
  consumed.innerText=Math.round(c)+" ml";
  water.style.height=Math.min(c/g*100,100)+"%";
}

/* ONBOARDING */
let step=0;
function startOnboarding(){
  onboarding.style.display="flex";
  step=0;renderStep();
}
function renderStep(){
  const box=stepBox;
  if(step===0){
    box.innerHTML=`
      <h2>Select Gender</h2>
      <div class="gender-grid">
        <button onclick="setGender('male')">üë® Male</button>
        <button onclick="setGender('female')">üë© Female</button>
      </div>`;
  }
  if(step===1){
    box.innerHTML=`
      <h2>Select Weight (kg)</h2>
      <div class="rwrap">
        <div class="center-line"></div>
        <div class="ruler" id="wr"></div>
      </div>
      <div id="wv"></div>
      <button onclick="next()">Next</button>`;
    buildRuler(wr,30,200,profile.weight||70,v=>wv.innerText=v+" kg",v=>profile.weight=v);
  }
  if(step===2){
    box.innerHTML=`
      <h2>Select Height (cm)</h2>
      <div class="rwrap">
        <div class="center-line"></div>
        <div class="ruler" id="hr"></div>
      </div>
      <div id="hv"></div>
      <button onclick="next()">Next</button>`;
    buildRuler(hr,100,220,profile.height||170,v=>hv.innerText=v+" cm",v=>profile.height=v);
  }
  if(step===3){
    box.innerHTML=`
      <h2>Select Age</h2>
      <div class="age-wheel" id="age"></div>
      <button onclick="finish()">Finish</button>`;
    buildAge();
  }
}
function setGender(g){profile.gender=g;haptic();next()}
function next(){step++;renderStep()}
function finish(){
  localStorage.setItem("profile",JSON.stringify(profile));
  onboarding.style.display="none";
  updateUI();
}

/* RULER */
function buildRuler(el,min,max,val,show,set){
  el.innerHTML="";
  for(let i=min;i<=max;i++){
    let t=document.createElement("div");
    t.className="tick"+(i%5===0?" major":"");
    if(i%5===0){let s=document.createElement("span");s.innerText=i;t.appendChild(s)}
    el.appendChild(t);
  }
  el.scrollLeft=(val-min)*22;
  el.onscroll=()=>{
    let v=min+Math.round(el.scrollLeft/22);
    set(v);show(v);haptic();
  };
}

/* AGE */
function buildAge(){
  age.innerHTML="";
  for(let i=10;i<=80;i++){
    let d=document.createElement("div");
    d.className="age-item"+(i===profile.age?" active":"");
    d.innerText=i;
    d.onclick=()=>{profile.age=i;buildAge();haptic()};
    age.appendChild(d);
  }
}

/* DRINK */
function openDrink(){drinkModal.style.display="flex"}
function selectDrink(t){
  let ml=250;
  data[today].consumed+=ml*DRINKS[t];
  drinkModal.style.display="none";
  updateUI();
}

/* INIT */
if(!profile.gender) startOnboarding();
else updateUI();
</script>

</body>
</html>
